<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zimax.mcrs.update.mapper.DeviceRollbackVoMapper">

    <!--查询-->
    <select id="getDevice" resultType="com.zimax.mcrs.update.pojo.DeviceRollbackVo">
        SELECT a.app_id,a.program_installation_path,a.executor_installation_path,c.version,c.upload_strategy,c.upload_id,b.upgrade_status,b.version_rollback_time,b.device_rollback_id
        FROM eqi_device a
        JOIN dev_rollback b ON a.device_id = b.device_id
        JOIN upd_upload c ON b.upload_id = c.upload_id
        <where>
            <if test="appId !=null and appId !=''">
                and a.app_id = '${appId}'
            </if>
        </where>
        ORDER BY b.version_rollback_time DESC
        LIMIT 1;
    </select>


</mapper>
